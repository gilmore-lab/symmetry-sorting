\documentclass[11pt, twoside]{article}
\usepackage{boisik}
\usepackage[OT1]{fontenc}
\usepackage[affil-it]{authblk}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{multicol}
\usepackage{natbib}
\usepackage{geometry}
\usepackage{amsmath}
\usepackage{lineno}
\usepackage{multirow}
\usepackage[dvipsnames]{xcolor}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}
\usepackage{xcolor}
\usepackage{float}
\usepackage{wrapfig}
\usepackage[belowskip=-10pt,aboveskip=0pt]{caption}
\captionsetup[figure]{font=small,labelfont=normalsize}

\linenumbers
 \geometry{a4paper, total={170mm,257mm}, left=20mm, top=20mm}

\renewcommand{\baselinestretch}{1.3}

\title{\huge Perceptual Similarities Among Wallpaper Group Exemplars}
\author[1,2]{Peter J. Kohler}
\author[3]{Shivam Vedak}
\author[3]{Rick O. Gilmore}

\affil[1]{\small York University, Department of Psychology, Toronto, ON M3J 1P3, Canada}
\affil[2]{\small Centre for Vision Research, York University, Toronto, ON, M3J 1P3, Canada}
\affil[3]{\small Department of Psychology, The Pennsylvania State University, Pennsylvania, USA}

\date{}

\begin{document}

\maketitle

% about 200 words
\begin{abstract}Symmetries are abundant within the visual environment, and many animals species are sensitive to visual symmetries. Wallpaper groups constitute a class of 17 regular textures that each contain a distinct combination of the four fundamental symmetries, translation, reflection, rotation and glide reflection, and together represent the complete set of possible symmetries in two-dimensional images. Wallpapers are visually compelling and elicit responses in visual brain areas that precisely capture the symmetry content of each group in humans and other primates. Here we ask to what extent exemplars from the same wallpaper group are perceptually similar. We algorithmically produce a set of well-matched exemplars from 5 of the 17 wallpaper groups and instructed participants to freely sort the exemplars from each group into as many subsets as they wished based on any criteria they saw appropriate. \textit{P1}, the simplest of the 17 groups, was consistently rated more self-similar than any other group, while the other four groups, although varying in symmetry content, were comparable in self-similarity. Our results suggest that except for the most extreme case (\textit{P1}), perceived self-similarity of wallpaper groups is not directly tied to categories of symmetry based on group theory.\end{abstract}

\section*{Introduction}
Symmetry has been recognized as important for human visual perception since the late 19th century \citep{mach_1959}. In the two spatial dimensions relevant for images, symmetries can be combined in 17 distinct ways, \textit{the wallpaper groups} \citep{RN1562,RN1563,RN1425}. Wallpaper groups are different from stimuli typically used to probe the role of symmetry in visual perception in two ways: First, they contain combinations of the four fundamental symmetry types translation, reflection, rotation and glide reflection, rather than just reflection or mirror symmetry, which have been the focus of most vision research. Second, the symmetries in wallpaper groups are repeated to tile the plane, rather than positioned at a single image location as is usually the case. These differences, and the fact that wallpaper groups together form the complete set of symmetries possible in the two-dimensional image plane, make wallpapers an interesting stimulus set for studying perception of visual symmetries.
\begin{wrapfigure}{r}{0.4\textwidth}
	\centering
	\includegraphics[width=0.38\textwidth]{./figures/wpg_structure.pdf}
	\caption{The fundamental region and lattice structure of the five wallpaper groups used in the study. The complete wallpaper is shown in the left-hand column with a shaded region that is repeated and enlarged in the right-hand column. The colored outline in the enlarged region indicates the repeating lattice for each group, while the shaded area indicates the fundamental region (see text). For \textit{P1} the fundamental region covers the entire lattice. Note that even though \textit{P6} and \textit{P31M} have the same fundamental region and lattice shapes, they differ in terms of the symmetries present within the lattice - most notably, \textit{P31M} contains reflection symmetry while \textit{P6} does not. The symmetry content of each group is detailed on the wallpaper group \href{https://en.wikipedia.org/wiki/Wallpaper_group}{wikipedia page}.}
	\label{fig:wpg_structure}
\end{wrapfigure}
Brain imaging studies using functional MRI \citep{RN1725} and EEG \citep{RN1959,kohler_clarke_2021} have shown that the human visual system carries detailed and precise representations of the symmetries within the individual wallpaper groups. Functional MRI evidence from macaque monkeys reveal similar representations in analogous areas of the macaque visual system \citep{audurier_symmetry_2021}.

These representations, complex as they are, do not appear to be readily available for driving conscious behaviour: Humans have limited intuitive sense of group membership for wallpaper group exemplars, as evidenced by behavioral experiments showing that although naïve observers can distinguish many of the wallpaper groups \citep{RN1253}, they tend to sort exemplars into fewer (4-12) sets than the number of wallpaper groups, often placing exemplars from different wallpaper groups in the same set \citep{RN172}. Wallpaper groups are nonetheless visually compelling, and anecdotally we have observed that exemplars from a given group can be quite perceptually diverse. This observation inspired the current study. Here, we use behavioral sorting, a common technique to study perceptual categorization \citep{Milton2008-ez,Pothos2011-vi}, to probe the perceptual self-similarity of different exemplars from the same wallpaper group, and assess the extent to which self-similarity varies across five groups. 

We algorithmically generated 20 well-matched exemplars from each group (see Figures \ref{fig:wpg_structure} and \ref{fig:wpg_exemplars} for a selection of the exemplars, and the \nameref{methods} section for details on how they were generated) and printed them out on white cardstock. We then gave participants the 20 cards with exemplars from each wallpaper group, and asked them to freely sort them into as many subsets as they wished based on any criteria they saw appropriate. This approach allowed us to compare the five wallpaper groups, both in terms of how many subsets participants generated, and also in terms of the \textit{Jaccard index}, a summary statistic capturing the similarity across exemplar pairs for each group. Within each group, we were also able to identify exemplar pairs that were rated as highly similar and highly dissimilar. Our main conclusion is that \textit{P1} was systematically more self-similar than the any other groups, while the other four other groups could not be distinguished on these measures. We also show that for all five groups, participants consistently group certain pairs of exemplars together, although the number of consistent pairs varies among groups. Our results open the door to further investigations into the factors that drive perceptual similarity among wallpaper group exemplars, and indeed among exemplars from different classes of structured patterns. 

\begin{figure}[H]
	\centering
	\includegraphics[width=\linewidth]{./figures//wpg_exemplars.pdf}
	\caption{5 of the 20 exemplars used for each group are shown to highlight the diversity among exemplars.}
	\label{fig:wpg_exemplars}
\end{figure}

\section*{Results}
Wallpaper group \textit{P1} was more self-similar than the other four groups. This was evident in the number of sets generated for this group across participants, which was lower for \textit{P1} (median = 3) than for the other groups (median = 4-5, see Figure \ref{fig:n_sets_summary}). We confirmed this observation statistically by running a repeated measures analysis of variance (ANOVA) with group as a fixed factor and participant as a random factor, which revealed a significant effet of group ($F(4, 124) = 7.330, p < 0.0001)$). Post-hoc pairwise \textit{t}-tests showed that the mean number of sets was lower for \textit{P1} than all other groups, but no other means differed.
\begin{figure}[t]
	\centering
	\includegraphics[width=\linewidth]{./figures/nsets_summary.pdf}
	\caption{Boxplots showing the number of subsets generated by participants for each of the wallpaper groups. The lower box boundary is the 25th percentile. The dark line in the box is the median. The upper box boundary is the 75th percentile. The “whiskers” show -/+ the interquartile range * 1.5.}
	\label{fig:n_sets_summary}
\end{figure}
Next, we computed the Jaccard index (see \nameref{methods}) across participants for every pairwise combination of exemplars in each group. This provides a measure of the similarity between exemplars within each group. \textit{P1} had sysmetically higher Jaccard indices than the four other groups (see Figure \ref{fig:jaccard_summary}), as confirmed by an ANOVA with wallpaper group as a factor. The analysis revealed a statistically signficant effect of group ($F(4, 495)=20.178, p < 0.0001$). Post-hoc pairwise \textit{t}-tests showed that \textit{P1} had higher Jaccard indices than all other groups ($ps < 0.0001$). The fact that the group (\textit{P1}) for which fewer subsets were generated also had higher Jaccard indices than the other groups illustrates the inherent link between the two measures. For wallpaper groups where the 20 exemplars are sorted into fewer subsets, each individual exemplar pair is more likely to be a member of the same subset, and less likely to be a member of distinct subsets. This in turn leads to higher Jaccard indices. Our pairwise \textit{t}-tests also showed that \textit{P31M} had lower Jaccard indices than \textit{P6} ($p = 0.037$). This effect is relatively weak, but may reflect real differences in how consistently exemplars were grouped together across participants. We will explore this idea more in depth shortly, but for now we can conclude that out of the five groups tested, \textit{P1} is the only one that can be reliably differentiated based on our measures, being higher on self-similarity among the exemplars, and thus lower on diversity among exemplars. 

\begin{figure}[t]
	\centering
	\includegraphics[width=\linewidth]{./figures/jaccard_summary.pdf}
	\caption{Boxplots showing Jaccard indices for every pairwise combination of exemplars in each of the wallpaper groups. Note that each data point here is the Jaccard index for a particular exemplar pair calculated across participants, unlike Figure \ref{fig:n_sets_summary} were each data point is a participant. The box boundary and whiskers follow the same logic as in Figure \ref{fig:n_sets_summary}. The exemplar pairs with the highest Jaccard indices have been highlighted with stars. Those outlier pairs are explored further in Figure \ref{fig:jaccard_inspection}.}
	\label{fig:jaccard_summary}
\end{figure}

In order to quantify the extent to which exemplars were consistently grouped together, we ran a permutation analysis in which exemplar labels were shuffled among the sets generated for each participant (see \nameref{methods}). This provides, for each group, the expected distribution of Jaccard indices for every pairwise combination of exemplars, if exemplars were assigned randomly to subsets. And the analysis allows us to compute an empirical \textit{z}-score that expressed the extent to which a given pair of exemplars deviates from random assignment. 
\begin{wraptable}{r}{0.5\textwidth}
	\centering
	\begin{tabular}[t]{ |p{2cm}||p{2cm}|p{2cm}| }
		\hline
		\multicolumn{3}{|c|}{consistent pairings} \\
		\hline
		group & $p<0.01$ & $p<0.0001$ \\
		\hline
		\textit{P1}   & 6  & 1  \\
		\textit{P31M} & 17 & 10 \\
		\textit{P3M1} & 12 & 3  \\
		\textit{P6}   & 17 & 11 \\
		\textit{P6M}  & 15 & 4  \\
		\hline
	\end{tabular}
	\caption{Number of consistent pairings at two different $\alpha$-levels for the five groups.  }
	\label{table:pairings}
\end{wraptable}
Because the random distribution is generated by shuffling exemplars across the specific sets generated by each participant for each group, this \textit{z}-score is independent of the number of sets. If for a given group, none of the pairs deviate significantly from the random distribution, it would indicate that no exemplar pairs were consistently grouped together across participants. To estimate the extent to which this is the case, we look at the distribution of \textit{z}-scores across the pairs for each group, as plotted in Figure \ref{fig:jaccard_permutation}, and count the number of pairs for each group for which the \textit{p}-value associated with the threshold exceeds a given $\alpha$ value. At a threshold of $\alpha = 0.01$, several pairs survive for all groups, and even at a much more conservative criterion of $\alpha = 0.0001$ most groups have more than one pairing that survives (see Table \ref{table:pairings}). It is worth noting that the latter threshold ($\alpha = 0.0001$) is lower than the $\alpha$ associated with a Bonferroni correction within group, given that there are 190 pairs per group: \[ \alpha = \frac{0.05}{190} = 0.0003 \].
So we conclude that for several exemplar pairs, participants are consistent in how they tend to pair the exemplars. It is interesting to consider that this measure of consistency might provide another way of differentiating wallpaper groups in terms of perceptual self-similarity. While groups \textit{P31M}, \textit{P3M1}, \textit{P6} and \textit{P6M} have comparable Jaccard scores (see Figure \ref{fig:jaccard_summary}), they differ in the number of consistent pairings, with \textit{P31M} and \textit{P6} producing more consistent pairs than the other two (see Figure \ref{fig:jaccard_permutation}). 

\begin{figure}[H]
	\centering
	\includegraphics[width=.9\linewidth]{./figures/jaccard_permutation.png}
	\caption{Distribution of \textit{z}-scores across the 190 pairs in each of the five wallpaper groups. The two lines indicate the \textit{z}-scores associated with $\alpha$ of 0.01 and 0.0001, respectively.}
	\label{fig:jaccard_permutation}
\end{figure}

The Jaccard indices also allow us to focus on exemplar pairs that have a high level of similarity relative to the rest of the pairs in the set. We do this by identifying outliers pairs from each group in term of Jaccard indices, as identified with stars in Figure \ref{fig:jaccard_summary}. Because the Jaccard indices are computed across participants, these outliers are also among the pairs most consistently sorted together, as identified in Figure \ref{fig:jaccard_permutation}. For each exemplar in each outlier pair, we can visualize the pairwise similarity (as measured by the Jaccard index) to every other exemplar in the set (see Figure \ref{fig:jaccard_inspection}). That is, we can visualize portions of the network of perceived similarity within a set of exemplars. Future work could probe the extent to which networks of perceived similarity have similar structure across wallpaper groups and examine what perceptual features best account for participants' perceptions of exemplar similarity.

\begin{figure}[hbt!]
	\centering
	\includegraphics[width=.9\linewidth]{./figures/jaccard_inspection.pdf}
	\caption{For each wallpaper group, we identified the two most self-similar exemplars, the same pair that is indicated by the right-most datapoint for each group in Figure \ref{fig:jaccard_permutation}. The two circular network plots are showing the pairwise similarities between those two exemplars and every other exemplar in the set. The pairwise similarities across all exemplars are plotted as a similarity matrix and on the rightmost side of the plot, the two most self-similar exemplars (bottom) are plotted with the exemplar that was least similar to both (top). The connecting lines between the exemplars indicate the similarity.}
	\label{fig:jaccard_inspection}
\end{figure}

\section*{Discussion}
Previous work has demonstrated that visual cortex of both humans and macaque monkeys carries highly detailed representations of the symmetries within wallpaper groups, as evidenced by systematic differences in the magnitude of the response elicited by different groups \citep{RN1725,kohler_clarke_2021,audurier_symmetry_2021}. This distinction between groups can also be observed in psychophysical threshold measurements \citep{kohler_clarke_2021}, although observers may not have a strong awareness of the wallpaper group membership of individual exemplars \citep{RN172}. In the current study, we explored a new piece of the story about how wallpaper groups are processed by the visual system, namely the issue of how self-similar different exemplars from the \textit{same} wallpaper group appear to untrained observers. We tested this by asking participants to spontaneously sort 20 exemplars from each of five wallpaper groups into different subsets. 

Our first finding concerns the number of subsets generated for each group. We find that \textit{P1} is divided into fewer subsets than the other four groups. This indicates that the limited complexity of this group, which contains only translation symmetry, has a direct effect of the number of distinct subsets. The relationship between complexity / symmetry content and number of subsets produced is not straightforward, however, as indicated by the fact that \textit{P6M} is not consistently grouped into more subsets than \textit{P6}, \textit{P3M1} and \textit{P31M}, despite the fact that these other groups all contain fewer symmetries than \textit{P6M} - and generate weaker brain activity \citep{kohler_clarke_2021}. We speculate that this lack of further differentiation is a result of an upper limit on how additional complexity can influence perceptual self-similarity. 

We also computed Jaccard indices that, for every possible exemplar pair, expresses the frequency of those two exemplars being grouped together. As described above, the average Jaccard index for a group is inherently linked to the number of subsets produced for that group, because fewer subsets mean that exemplars are more likely to be made members of the same pair, and less likely to be made members of the same pair. It is therefore not surprising that we find the same general pattern for Jaccard indices and number of subsets, namely that \textit{P1} has higher indices than the other groups. The advantage of the Jaccard indices, however, is that they allow us to conduct a permutation analysis that quantifies the extent to which pairs of exemplars are consistently grouped together across participants, independent of the number of sets produced for a given group. It is important to note that consistency in the choice of which exemplars to group into subsets is not an unavoidable consequence of our experimental design, and it does not follow naturally from the results described so far. It would be perfectly possible for participants to group the sets together, producing fewer subsets for \textit{P1} as observed, but exhibit no consistency across participants at all. That is not what we see, however. Even when setting a conservative threshold, all five groups produce one or more pairs that are consistently grouped together, demonstrating that the sorting of exemplars into subsets is not done randomly or in an arbitrary across the participants. Rather, different individuals agree to some extent on which exemplars belong together. Because our measure of consistency is independent of the number of subsets produced for a given group, it allows us to show that although \textit{P1} has the highest overall Jaccard indices (as a result of the fewer sets produced for this group), it in fact produces fewer consistent pairs than other groups (see Table \ref{table:pairings}).

In sum, we find consistencies in the way that untrained human observers sort wallpaper images. Observers sort exemplars with translational symmmetry alone (\textit{P1}) into smaller numbers of sets than exemplars with rotational or reflection symmetry. On average, pairs of \textit{P1} exemplars are sorted together more often than exemplars from other wallpaper groups. At the same time, some specific exemplar pairs from wallpaper groups with 3- or 6- fold rotational or reflection symmetry are sorted together substantially more often than predicted by chance. 

Taken together, our results suggest that human observers are sensitive to the dimensions of 2D symmetry (translation, rotation, and reflection) embedded in wallpaper exemplars. However, their behavior shows only weak evidence that group-theoretic measures of symmetry influence the perception of self-similarity. These results contribute to a small, but growing literature on the the perception of visual aesthetics \citep{Carneiro2012-ph,Graham2010-yf,Friedenberg2012-gf,Laine-Hernandez2008-sg,Richards1972-gl} where symmetry is one of many contributing factors.

\section*{Materials and Methods}
\label{methods}

\subsection*{Participants}
33 participants (9 Male, 24 Female), ranging in age between 18 and 35 completed this study. All participants had self- reported 20/20 or corrected to 20/20 vision. We obtained written consent to participate from all participants under procedures approved by the Institutional Review Board of The Pennsylvania State University (\#38536). The research was conducted according to the principles expressed in the Declaration of Helsinki. Participants include \textit{n}=11 collected and described in \citep{vedak_thesis}, plus an additional group collected at a later date using the same protocol.

\subsection*{Stimulus Generation}
Five wallpaper groups (\textit{P1}, \textit{P3M1}, \textit{P31M}, \textit{P6} and \textit{P6M}) that has previously been shown to be high in self-similarity \citep{RN172}, were selected. 20 exemplars from each of these five wallpaper groups were generated using a modified version of the methodology developed by Clarke and colleagues \citep{RN172} that we have described in detail elsewhere \citep{RN1725}. Briefly, exemplar patterns for each group were generated from random-noise textures, which were then repeated and transformed to cover the plane, according to the symmetry axes and geometric lattice specific to each group. The use of noise textures as the starting point for stimulus generation allowed the creation of an almost infinite number of distinct exemplars of each wallpaper group. To make individual exemplars as similar as possible we replaced the power spectrum of each exemplar with the median across exemplars within a group. These images were printed onto white cardstock and cut into squares, allowing participants to manipulate the orientation of the images during the sorting tasks. Five exemplars from each group are shown (in reduced size) in Figure \ref{fig:wpg_exemplars}. 

\subsection*{Procedure}
Participants were presented with the 20 exemplars of a single wallpaper group (i.e. P1, P3M1, P31M, P6, P6M) and instructed to sort them into subsets by placing them into piles. Participants were advised to sort the exemplars into as many piles as they deemed necessary based on whatever criteria they desired. There were no time constraints placed on this sorting task, and the participants were allowed to move exemplars between piles until they were satisfied with their classification. This method was then repeated for the remaining four wallpaper groups for each participant, with group presentation order randomized between participants. These tasks were carried out on a large table with sufficient space to randomly lay out all twenty exemplars of each set, illuminated by normal overhead room lighting. Upon completion of each sorting task, participants were asked to verbalize which features they used to sort the exemplars. After completion of all five sorting tasks, participants were asked which if they had a distinct method for sorting the images, and if any wallpaper group was particular easy or difficult to sort.

\subsection*{Generating the Jaccard Index}
The data was prepared for analysis by creating one binary variable for each subset created by each participant within a sorting task. Then, each exemplar was assigned a value of one (1) if it was included in a subset, or a value zero (0) if it was not. Next, the similarity of each pair of exemplars within a sorting task was calculated using the Jaccard index, a measure of similarity and diversity for binary data. This index is calculated by the equation  \[ J = \frac{x}{x + y + z} \] with x representing the number of subsets that contained both exemplars, and y and z the number of subsets that contain only one exemplar of the pair \citep{capra_factor_2005}, across participants. Thus, the Jaccard index is the ratio of the number of subsets containing both exemplars of a pair to the number of subsets containing at least one of the exemplars of a pair, thereby excluding subsets with joint absences.

\subsection*{Permutation Analysis}
The permutation analysis involved generating a randomized dataset, as follows. For each participant and wallpaper group, we randomized which specific exemplars were sorted together. This retained the basic structure of each participants' sorting data--the number of subsets created--but randomized the relationship between specific wallpaper exemplars that were sorted together across the participants. We then created 1,000 such permuted datasets, and calculated the Jaccard index for each exemplar pair within each group for each of the permuted datasets. This permitted the calculation of an \emph{empirical} Jaccard index based on the permuted data from which distributional statistics like \textit{z} could be calculated. The \emph{observed} Jaccard indices for each exemplar pair were then compared to the empirically-derived reference distribution to determine which exemplar pairs were sorted together more frequently than chance would predict.

% Bibliography
\begin{multicols}{2}
\small
\bibliographystyle{apalike} 
\bibliography{literature}
\end{multicols}

\end{document}